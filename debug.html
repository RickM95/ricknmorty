<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Rick and Morty</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; }
        .success { background-color: #d4edda; }
        .error { background-color: #f8d7da; }
    </style>
</head>
<body>
    <h1>Debug Page - Rick and Morty</h1>
    
    <div id="tests"></div>
    
    <script>
        const tests = [];
        
        function addTest(name, result, details = '') {
            tests.push({ name, result, details });
            updateDisplay();
        }
        
        function updateDisplay() {
            const container = document.getElementById('tests');
            container.innerHTML = tests.map(test => 
                `<div class="test ${test.result ? 'success' : 'error'}">
                    <strong>${test.name}:</strong> ${test.result ? 'PASS' : 'FAIL'}
                    ${test.details ? `<br><small>${test.details}</small>` : ''}
                </div>`
            ).join('');
        }
        
        // Test 1: Check if images exist
        function testImages() {
            const images = [
                './images/portal.png',
                './images/carousel/1.jpg',
                './images/carousel/2.jpg',
                './images/header/rick-and-morty-rick.gif'
            ];
            
            let loaded = 0;
            let failed = 0;
            
            images.forEach(src => {
                const img = new Image();
                img.onload = () => {
                    loaded++;
                    if (loaded + failed === images.length) {
                        addTest('Images Loading', loaded > 0, `${loaded}/${images.length} images loaded`);
                    }
                };
                img.onerror = () => {
                    failed++;
                    console.error('Failed to load:', src);
                    if (loaded + failed === images.length) {
                        addTest('Images Loading', loaded > 0, `${loaded}/${images.length} images loaded`);
                    }
                };
                img.src = src;
            });
        }
        
        // Test 2: Check if CSS files exist
        function testCSS() {
            const links = document.querySelectorAll('link[rel="stylesheet"]');
            addTest('CSS Files', links.length > 0, `Found ${links.length} CSS links`);
        }
        
        // Test 3: Test API connection
        async function testAPI() {
            try {
                const response = await fetch('https://rickandmortyapi.com/api/character/1');
                const data = await response.json();
                addTest('API Connection', !!data.name, `Got character: ${data.name || 'Unknown'}`);
            } catch (error) {
                addTest('API Connection', false, error.message);
            }
        }
        
        // Test 4: Test localStorage
        function testLocalStorage() {
            try {
                localStorage.setItem('test', 'value');
                const value = localStorage.getItem('test');
                localStorage.removeItem('test');
                addTest('LocalStorage', value === 'value', 'Read/write successful');
            } catch (error) {
                addTest('LocalStorage', false, error.message);
            }
        }
        
        // Test 5: Test module loading
        async function testModules() {
            try {
                const module = await import('./scripts/darkmode.js');
                addTest('Module Loading', !!module.initDarkMode, 'Dark mode module loaded');
            } catch (error) {
                addTest('Module Loading', false, error.message);
            }
        }
        
        // Run all tests
        document.addEventListener('DOMContentLoaded', () => {
            addTest('DOM Ready', true, 'DOM loaded successfully');
            testCSS();
            testImages();
            testAPI();
            testLocalStorage();
            testModules();
        });
    </script>
</body>
</html>